<IfModule mod_ssl.c>
<VirtualHost *:443>
  ServerName dev.scraper.fmdj.fr

  ProxyPass / http://localhost:8080/
  ProxyPassReverse / http://localhost:8080/

  RewriteEngine on

  RewriteCond %{REQUEST_URI} ^/wss-internal [NC]
  RewriteRule /(.*) "ws://localhost:8080/$1" [P,L]

  <Location />
    AuthType Basic
    AuthName "Restricted Content"
    AuthUserFile /etc/apache2/.htpasswd
    Require valid-user
  </Location>

  SSLCertificateFile /etc/letsencrypt/live/dev.scraper.fmdj.fr/fullchain.pem
  SSLCertificateKeyFile /etc/letsencrypt/live/dev.scraper.fmdj.fr/privkey.pem
  Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>
</IfModule>